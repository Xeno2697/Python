<!DOCTYPE HTML>
<html>
	<head>
		<title>Joy</title>
		<meta charset="utf-8">
		<meta name="description" content="Example page of use pure Javascript JoyStick">
		<meta name="author" content="Roberto D'Amico">
		<link rel="shortcut icon" type="image/png" href="http://bobboteck.github.io/img/roberto-damico-bobboteck.png">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
		<style>
*
{
	box-sizing: border-box;
}
body
{
	margin: 0px;
	padding: 0px;
	font-family: monospace;
}
.row
{
	display: inline-flex;
	clear: both;
}
.columnLateral
{
  float: left;
  width: 15%;
  min-width: 300px;
}
.columnCetral
{
  float: left;
  width: 70%;
  min-width: 300px;
}
#joy2Div
{
	width:200px;
	height:200px;
	margin:50px
}
#joystick
{
	border: 1px solid #FF0000;
}
#joystick2
{
	border: 1px solid #0000FF;
}
		</style>
		<script src="{{ url_for('static', filename='js/joy.js') }}"></script>
	</head>
	<body>
		<div class="columnLateral">
			<div id="joy1Div" style="width:800px;height:800px;margin:100px"></div>
			Posizione X:<input id="joy1PosizioneX" type="text" /><br />
			Posizione Y:<input id="joy1PosizioneY" type="text" /><br />
			Direzione:<input id="joy1Direzione" type="text" /><br />
			X :<input id="joy1X" type="text" /></br>
			Y :<input id="joy1Y" type="text" />
		</div>


		<script type="text/javascript">
			var joy1IinputPosX = document.getElementById("joy1PosizioneX");
			var joy1InputPosY = document.getElementById("joy1PosizioneY");
			var joy1Direzione = document.getElementById("joy1Direzione");
			var joy1X = document.getElementById("joy1X");
			var joy1Y = document.getElementById("joy1Y");
			/*
			setInterval(function(){ joy1IinputPosX.value=Joy1.GetPosX(); }, 50);
			setInterval(function(){ joy1InputPosY.value=Joy1.GetPosY(); }, 50);
			setInterval(function(){ joy1Direzione.value=Joy1.GetDir(); }, 50);
			setInterval(function(){ joy1X.value=Joy1.GetX(); }, 50);
			setInterval(function(){ joy1Y.value=Joy1.GetY(); }, 50);
			*/
			// Create JoyStick object into the DIV 'joy1Div'
			var Joy1 = new JoyStick('joy1Div', {}, function(stickData) {
				joy1IinputPosX.value = stickData.xPosition;
				joy1InputPosY.value = stickData.yPosition;
				joy1Direzione.value = stickData.cardinalDirection;
				joy1X.value = stickData.x;
				joy1Y.value = stickData.y;
			});
            setInterval(function () { send(Joy1.GetX(), Joy1.GetY()) }, 300);

		</script>

        <script type="text/javascript" charset="utf-8">
            var socket = io();
            // joystickが変更されると呼び出される
            function send(x,y) {
            socket.emit('move_request', {x: x, y: y});
            }
        </script>
	</body>
</html>